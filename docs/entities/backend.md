# –°—É—â–Ω–æ—Å—Ç–∏ Backend –º–æ–¥—É–ª—è

–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö Entity –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ Backend –º–æ–¥—É–ª—è.

---

## üìã –°–ø–∏—Å–æ–∫ —Å—É—â–Ω–æ—Å—Ç–µ–π

1. **User** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
2. **UserCredentials** - –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. **Token** - Refresh —Ç–æ–∫–µ–Ω –¥–ª—è JWT
4. **UserBankClient** - –°–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –±–∞–Ω–∫–æ–≤ (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–∞–Ω–∫–æ–≤)

---

## 1. User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–•—Ä–∞–Ω–∏—Ç –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö —Å–∏—Å—Ç–µ–º—ã.

### –ü–æ–ª—è

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|------|-----|----------|---------------|------------|----------|
| `id` | `UUID` | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | ‚úÖ | ‚úÖ | BaseEntity |
| `firstname` | `String` | –ò–º—è | ‚ùå | ‚ùå | UserEntity |
| `lastname` | `String` | –§–∞–º–∏–ª–∏—è | ‚ùå | ‚ùå | UserEntity |
| `secondname` | `String` | –û—Ç—á–µ—Å—Ç–≤–æ | ‚ùå | ‚ùå | UserEntity |
| `email` | `String` | Email –∞–¥—Ä–µ—Å | ‚ùå | ‚ùå | UserEntity |
| `createdAt` | `LocalDateTime` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è | ‚úÖ | ‚ùå | BaseEntity |
| `updatedAt` | `LocalDateTime` | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | ‚ùå | ‚ùå | BaseEntity |

### –°–≤—è–∑–∏
- **OneToOne** —Å `UserCredentials` - –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –æ–¥–Ω–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **OneToMany** —Å `UserBankClient` - –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–≤—è–∑–µ–π —Å –±–∞–Ω–∫–∞–º–∏
- **–°–≤—è–∑—å —Å Bank Module** —á–µ—Ä–µ–∑ `UserBankClient` - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–∞–Ω–∫–æ–≤ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –°–≤—è–∑—å —Å Bank Module
- –°–≤—è–∑—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É `UserBankClient`
- –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å—á–µ—Ç–∞ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–∞–Ω–∫–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ö–∞–∂–¥—ã–π Bank Module –æ—Å—Ç–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º
- –°–≤—è–∑—å: `User` ‚Üí `UserBankClient` ‚Üí `Client.id` (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ ID, –±–µ–∑ FK)

### –ü—Ä–∏–º–µ—Ä—ã –∑–Ω–∞—á–µ–Ω–∏–π

```java
id: "550e8400-e29b-41d4-a716-446655440000"  // UUID
firstname: "Ivan"
lastname: "Ivanov"
secondname: "Petrovich"
email: "ivan@example.com"
createdAt: 2025-01-20T10:00:00
updatedAt: 2025-01-20T10:00:00
```

### –ò–Ω–¥–µ–∫—Å—ã
- `email` - –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)
- `id` - –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á (UUID)

### SQL —Å—Ö–µ–º–∞

```sql
CREATE TABLE users (
    id UUID PRIMARY KEY,
    firstname VARCHAR(100),
    lastname VARCHAR(100),
    secondname VARCHAR(100),
    email VARCHAR(255),
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP,
    INDEX idx_email (email)
);
```

### –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç BaseEntity
- `UserEntity` –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `BaseEntity`
- `BaseEntity` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç: `id` (UUID), `createdAt`, `updatedAt`
- `@CreatedDate` –∏ `@LastModifiedDate` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `@EnableJpaAuditing`

### –°–≤—è–∑—å —Å Bank Module
- –°–≤—è–∑—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É `user_bank_clients`
- –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å—á–µ—Ç–∞ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–∞–Ω–∫–∞—Ö
- Bank Module **–Ω–µ –∑–Ω–∞–µ—Ç** –æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏ Backend - –ø–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è

---

## 2. UserCredentials (–£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–•—Ä–∞–Ω–∏—Ç –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

### –ü–æ–ª—è

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|------|-----|----------|---------------|------------|----------|
| `id` | `UUID` | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | ‚úÖ | ‚úÖ | BaseEntity |
| `login` | `String` | –õ–æ–≥–∏–Ω –¥–ª—è –≤—Ö–æ–¥–∞ | ‚úÖ | ‚úÖ | UserCredentialsEntity |
| `password` | `String` | –•—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å | ‚úÖ | ‚ùå | UserCredentialsEntity |
| `user` | `UserEntity` | –°–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º | ‚úÖ | ‚úÖ | UserCredentialsEntity |
| `createdAt` | `LocalDateTime` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è | ‚úÖ | ‚ùå | BaseEntity |
| `updatedAt` | `LocalDateTime` | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | ‚ùå | ‚ùå | BaseEntity |

### –°–≤—è–∑–∏
- **OneToOne** —Å `UserEntity` - —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (JPA —Å–≤—è–∑—å, –æ–¥–Ω–∞ –ë–î)

### –ü—Ä–∏–º–µ—Ä—ã –∑–Ω–∞—á–µ–Ω–∏–π

```java
id: "550e8400-e29b-41d4-a716-446655440000"  // UUID
login: "ivan_ivanov"
password: "$2a$10$..."  // BCrypt —Ö—ç—à
user: UserEntity(id=uuid-1, ...)
createdAt: 2025-01-20T10:00:00
updatedAt: 2025-01-20T10:00:00
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **password** –¥–æ–ª–∂–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ **—Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ** (BCrypt –∏–ª–∏ SHA-256)
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ plain text!
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `PasswordEncoder` –¥–ª—è —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

### –ò–Ω–¥–µ–∫—Å—ã
- `login` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å
- `user_id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å (–æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = –æ–¥–Ω–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

### SQL —Å—Ö–µ–º–∞

```sql
CREATE TABLE user_credentials (
    id UUID PRIMARY KEY,
    login VARCHAR(100) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    user_id UUID NOT NULL UNIQUE,
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    INDEX idx_login (login)
);
```

### –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç BaseEntity
- `UserCredentialsEntity` –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `BaseEntity`
- `BaseEntity` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç: `id` (UUID), `createdAt`, `updatedAt`
- `@CreatedDate` –∏ `@LastModifiedDate` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `@EnableJpaAuditing`

---

## 3. Token (Refresh —Ç–æ–∫–µ–Ω)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–•—Ä–∞–Ω–∏—Ç refresh tokens –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è JWT access tokens.

### –ü–æ–ª—è

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|------|-----|----------|---------------|------------|----------|
| `id` | `UUID` | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | ‚úÖ | ‚úÖ | BaseEntity |
| `userId` | `UUID` | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–∑ PostgreSQL) | ‚úÖ | ‚ùå | TokenEntity |
| `refreshToken` | `String` | Refresh token | ‚úÖ | ‚úÖ | TokenEntity |
| `expiresAt` | `LocalDateTime` | –í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è | ‚úÖ | ‚ùå | TokenEntity |
| `createdAt` | `LocalDateTime` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è | ‚úÖ | ‚ùå | BaseEntity |
| `updatedAt` | `LocalDateTime` | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | ‚ùå | ‚ùå | BaseEntity |

### –°–≤—è–∑–∏
- **–ù–µ—Ç –ø—Ä—è–º—ã—Ö JPA —Å–≤—è–∑–µ–π** - `userId` —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ `UUID` (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –¥—Ä—É–≥–æ–π –ë–î - PostgreSQL)
- –°–≤—è–∑—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø–æ –ª–æ–≥–∏–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–µ —á–µ—Ä–µ–∑ FK

### –ü—Ä–∏–º–µ—Ä—ã –∑–Ω–∞—á–µ–Ω–∏–π

```java
id: "550e8400-e29b-41d4-a716-446655440000"  // UUID
userId: "660e8400-e29b-41d4-a716-446655440001"  // UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ PostgreSQL
refreshToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
expiresAt: 2025-01-21T10:00:00
createdAt: 2025-01-20T10:00:00
updatedAt: 2025-01-20T10:00:00
```

### –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è
- **userId** - —ç—Ç–æ **–ù–ï –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á** (FK), —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –¥—Ä—É–≥–æ–π –ë–î (PostgreSQL)
- –•—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ `UUID` –¥–ª—è —Å–≤—è–∑–∏ –ø–æ –ª–æ–≥–∏–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `UserEntity.id`)
- **refreshToken** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º
- –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞ –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–¥–∞–ª–µ–Ω
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ H2 Database (in-memory –∏–ª–∏ file-based)

### –ò–Ω–¥–µ–∫—Å—ã
- `refresh_token` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å
- `user_id` - –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- `expires_at` - –∏–Ω–¥–µ–∫—Å –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç–µ–∫—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤

### SQL —Å—Ö–µ–º–∞ (H2)

```sql
CREATE TABLE tokens (
    id UUID PRIMARY KEY,
    user_id UUID NOT NULL,
    refresh_token VARCHAR(500) NOT NULL UNIQUE,
    expires_at TIMESTAMP NOT NULL,
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP,
    INDEX idx_user_id (user_id),
    INDEX idx_refresh_token (refresh_token),
    INDEX idx_expires_at (expires_at)
);
```

### –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç BaseEntity
- `TokenEntity` –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `BaseEntity`
- `BaseEntity` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç: `id` (UUID), `createdAt`, `updatedAt`
- `@CreatedDate` –∏ `@LastModifiedDate` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `@EnableJpaAuditing`

---

## 4. UserBankClient (–°–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –±–∞–Ω–∫–∞–º–∏)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–•—Ä–∞–Ω–∏—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –±–∞–Ω–∫–æ–≤. –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–º–µ—Ç—å —Å—á–µ—Ç–∞ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–∞–Ω–∫–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

### –ü–æ–ª—è

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|------|-----|----------|---------------|------------|----------|
| `id` | `UUID` | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | ‚úÖ | ‚úÖ | BaseEntity |
| `user` | `UserEntity` | –°–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º | ‚úÖ | ‚ùå | UserBankClientEntity |
| `bankClientId` | `UUID` | ID –∫–ª–∏–µ–Ω—Ç–∞ –≤ Bank Module | ‚úÖ | ‚ùå | UserBankClientEntity |
| `bankName` | `String` | –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–Ω–∫–∞ (vbank, abank, sbank) | ‚úÖ | ‚ùå | UserBankClientEntity |
| `isPrimary` | `Boolean` | –û—Å–Ω–æ–≤–Ω–æ–π –±–∞–Ω–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | ‚úÖ | ‚ùå | UserBankClientEntity |
| `createdAt` | `LocalDateTime` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è | ‚úÖ | ‚ùå | BaseEntity |
| `updatedAt` | `LocalDateTime` | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | ‚ùå | ‚ùå | BaseEntity |

### –°–≤—è–∑–∏
- **ManyToOne** —Å `UserEntity` - —Å–≤—è–∑—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (JPA —Å–≤—è–∑—å, –æ–¥–Ω–∞ –ë–î)
- **–°–≤—è–∑—å —Å Bank Module** —á–µ—Ä–µ–∑ `bankClientId` - UUID –∫–ª–∏–µ–Ω—Ç–∞ –≤ Bank Module (–Ω–µ FK, —Ä–∞–∑–Ω—ã–µ –ë–î)

### –ü—Ä–∏–º–µ—Ä—ã –∑–Ω–∞—á–µ–Ω–∏–π

```java
id: "550e8400-e29b-41d4-a716-446655440000"  // UUID
user: UserEntity(id=uuid-1, ...)
bankClientId: "660e8400-e29b-41d4-a716-446655440001"  // UUID –∫–ª–∏–µ–Ω—Ç–∞ –≤ vbank
bankName: "vbank"
isPrimary: true
createdAt: 2025-01-20T10:00:00
updatedAt: 2025-01-20T10:00:00
```

### –ò–Ω–¥–µ–∫—Å—ã
- `user_id` - –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- `bank_client_id` - –∏–Ω–¥–µ–∫—Å –¥–ª—è —Å–≤—è–∑–∏ —Å –∫–ª–∏–µ–Ω—Ç–æ–º –±–∞–Ω–∫–∞
- `bank_name` - –∏–Ω–¥–µ–∫—Å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –±–∞–Ω–∫—É
- `(user_id, bank_client_id)` - —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è

### SQL —Å—Ö–µ–º–∞

```sql
CREATE TABLE user_bank_clients (
    id UUID PRIMARY KEY,
    user_id UUID NOT NULL,
    bank_client_id UUID NOT NULL,
    bank_name VARCHAR(100) NOT NULL,
    is_primary BOOLEAN NOT NULL DEFAULT false,
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    UNIQUE (user_id, bank_client_id),
    INDEX idx_user_id (user_id),
    INDEX idx_bank_client_id (bank_client_id),
    INDEX idx_bank_name (bank_name)
);
```

### –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç BaseEntity
- `UserBankClientEntity` –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `BaseEntity`
- `BaseEntity` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç: `id` (UUID), `createdAt`, `updatedAt`
- `@CreatedDate` –∏ `@LastModifiedDate` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `@EnableJpaAuditing`

### –°–≤—è–∑—å —Å Bank Module
- `bankClientId` - UUID –∫–ª–∏–µ–Ω—Ç–∞ –≤ Bank Module (—Ç–∞–±–ª–∏—Ü–∞ `clients`)
- –≠—Ç–æ **–ù–ï –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á** (FK), —Ç–∞–∫ –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –¥—Ä—É–≥–æ–π –ë–î
- –•—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ `UUID` –¥–ª—è —Å–≤—è–∑–∏ –ø–æ –ª–æ–≥–∏–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `Client.id` –≤ Bank Module)
- Bank Module **–Ω–µ –∑–Ω–∞–µ—Ç** –æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏ Backend - –ø–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è
- –°–≤—è–∑—å: `UserBankClient.bank_client_id` ‚Üí `Client.id` (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ UUID)

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
- –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –≤ `user_bank_clients`
- –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–≤—è–∑—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –±–∞–Ω–∫–µ
- –ü–æ–ª–µ `isPrimary` —É–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –±–∞–Ω–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–ª–µ `bankName` –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –±–∞–Ω–∫ (vbank, abank, sbank)

---

## üîó –°–≤—è–∑–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏

```
User (1) ‚îÄ‚îÄ< (1) UserCredentials
User (1) ‚îÄ‚îÄ< (Many) Token (—Ç–æ–ª—å–∫–æ userId, –Ω–µ FK)
User (1) ‚îÄ‚îÄ< (Many) UserBankClient
UserBankClient.bank_client_id ‚Üí Client.id (Bank Module, —Ç–æ–ª—å–∫–æ ID, –Ω–µ FK)
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ —Å–≤—è–∑–µ–π

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    User     ‚îÇ
‚îÇ             ‚îÇ
‚îÇ  - id       ‚îÇ
‚îÇ  - username ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îÇ 1
       ‚îÇ
       ‚îÇ 1
       ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ UserCredentials     ‚îÇ
‚îÇ                     ‚îÇ
‚îÇ  - id               ‚îÇ
‚îÇ  - login            ‚îÇ
‚îÇ  - password (hash)  ‚îÇ
‚îÇ  - userId (FK)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    User     ‚îÇ
‚îÇ             ‚îÇ
‚îÇ  - id (UUID)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îÇ 1
       ‚îÇ
       ‚îÇ Many
       ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      Token          ‚îÇ
‚îÇ                     ‚îÇ
‚îÇ  - id               ‚îÇ
‚îÇ  - userId (Long)    ‚îÇ
‚îÇ  - refreshToken     ‚îÇ
‚îÇ  - expiresAt        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    User     ‚îÇ
‚îÇ             ‚îÇ
‚îÇ  - id (UUID)‚îÇ
‚îÇ  - firstname‚îÇ
‚îÇ  - lastname ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îÇ 1
       ‚îÇ
       ‚îÇ Many
       ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  UserBankClient         ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  - id                   ‚îÇ
‚îÇ  - userId (FK)          ‚îÇ
‚îÇ  - bankClientId         ‚îÇ
‚îÇ  - bankName             ‚îÇ
‚îÇ  - isPrimary            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îÇ (—Ç–æ–ª—å–∫–æ ID, –Ω–µ FK)
       ‚îÇ
       ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         BANK MODULE                 ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                   ‚îÇ
‚îÇ  ‚îÇ   Client    ‚îÇ                   ‚îÇ
‚îÇ  ‚îÇ             ‚îÇ                   ‚îÇ
‚îÇ  ‚îÇ  - id       ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ  ‚îÇ  - firstName‚îÇ                   ‚îÇ
‚îÇ  ‚îÇ  - lastName ‚îÇ                   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îÇ
‚îÇ                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–∏–º–µ—Ä—ã —Å–≤—è–∑–µ–π

**–û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –ù–µ—Å–∫–æ–ª—å–∫–æ –±–∞–Ω–∫–æ–≤:**
```
User (id=uuid-1, firstname="Ivan", lastname="Ivanov")
  ‚îú‚îÄ‚îÄ UserBankClient (id=uuid-2, userId=uuid-1, bankClientId=uuid-100, bankName="vbank", isPrimary=true)
  ‚îú‚îÄ‚îÄ UserBankClient (id=uuid-3, userId=uuid-1, bankClientId=uuid-200, bankName="abank", isPrimary=false)
  ‚îî‚îÄ‚îÄ UserBankClient (id=uuid-4, userId=uuid-1, bankClientId=uuid-300, bankName="sbank", isPrimary=false)

Bank Module (vbank):
  Client (id=100) ‚Üí Accounts ‚Üí Cards ‚Üí Transactions

Bank Module (abank):
  Client (id=200) ‚Üí Accounts ‚Üí Cards ‚Üí Transactions

Bank Module (sbank):
  Client (id=300) ‚Üí Accounts ‚Üí Cards ‚Üí Transactions
```

---

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ User –∏ UserCredentials
- **User** - –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–±–µ–∑ –ø–∞—Ä–æ–ª—è)
- **UserCredentials** - –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–∞—Ä–æ–ª—è–º–∏ –∏ –ª–æ–≥–∏–Ω–∞–º–∏ –æ—Ç–¥–µ–ª—å–Ω–æ

### 2. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª–µ–π
- **password** –¥–æ–ª–∂–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ **—Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ BCrypt –∏–ª–∏ SHA-256
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ –ø–∞—Ä–æ–ª–∏!

### 3. –¢–æ–∫–µ–Ω—ã –≤ H2
- **Token** —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ H2 (in-memory –∏–ª–∏ file-based)
- **userId** - –Ω–µ FK, —Ç–∞–∫ –∫–∞–∫ User –≤ –¥—Ä—É–≥–æ–π –ë–î
- –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞ –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–¥–∞–ª–µ–Ω

### 4. –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
- `id` (UUID) - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π
- `login` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º
- `refreshToken` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º
- `userId` –≤ UserCredentials - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º (–æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = –æ–¥–Ω–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

### 5. –ò–Ω–¥–µ–∫—Å—ã
- –°–æ–∑–¥–∞–π—Ç–µ –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö
- –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ `email`, `login`, `userId`, `refreshToken`

---

## üöÄ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ)

### User
- `phone` - —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–π –Ω–æ–º–µ—Ä
- `avatar` - URL –∞–≤–∞—Ç–∞—Ä–∞
- `birthDate` - –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
- `isActive` - –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `lastLoginAt` - –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞

### UserBankClient
- `lastUsedAt` - –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–Ω–∫–∞
- `preferences` - JSON —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±–∞–Ω–∫–∞
- `status` - —Å—Ç–∞—Ç—É—Å —Å–≤—è–∑–∏ (ACTIVE, SUSPENDED, CLOSED)

### UserCredentials
- `passwordChangedAt` - –¥–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è
- `failedLoginAttempts` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- `lockedUntil` - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–æ (–¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞)

### Token
- `deviceInfo` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- `ipAddress` - IP –∞–¥—Ä–µ—Å
- `userAgent` - User-Agent –±—Ä–∞—É–∑–µ—Ä–∞

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email
```java
Optional<User> user = userRepository.findByEmail(email);
```

### –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID
```java
Optional<User> user = userRepository.findById(userId);
```

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –±–∞–Ω–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```java
List<UserBankClient> userBanks = userBankClientRepository.findByUserId(userId);
// –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±–∞–Ω–∫–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å —Å—á–µ—Ç–∞
```

### –ü–æ–ª—É—á–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –±–∞–Ω–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```java
Optional<UserBankClient> primaryBank = userBankClientRepository.findByUserIdAndIsPrimaryTrue(userId);
```

### –ü–æ–ª—É—á–∏—Ç—å —Å–≤—è–∑—å —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –±–∞–Ω–∫–æ–º
```java
Optional<UserBankClient> bankClient = userBankClientRepository.findByUserIdAndBankName(userId, "vbank");
```

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–≤—è–∑–∏ –ø–æ bank_client_id
```java
List<UserBankClient> clients = userBankClientRepository.findByBankClientId(bankClientId);
```

### –ü–æ–ª—É—á–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ login
```java
Optional<UserCredentials> credentials = userCredentialsRepository.findByLogin(login);
```

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ–∫–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```java
List<Token> tokens = tokenRepository.findByUserId(userId);
```

### –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –ø–æ refresh token
```java
Optional<Token> token = tokenRepository.findByRefreshToken(refreshToken);
```

### –£–¥–∞–ª–∏—Ç—å –∏—Å—Ç–µ–∫—à–∏–µ —Ç–æ–∫–µ–Ω—ã
```java
tokenRepository.deleteByExpiresAtBefore(LocalDateTime.now());
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è Entity

–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º Entity —É–±–µ–¥–∏—Ç–µ—Å—å:

- [ ] –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ø–æ–º–µ—á–µ–Ω—ã `nullable = false`
- [ ] –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –ø–æ–º–µ—á–µ–Ω—ã `unique = true`
- [ ] –î–ª—è –¥–∞—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `LocalDateTime`
- [ ] –°–≤—è–∑–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö
- [ ] –ì–µ—Ç—Ç–µ—Ä—ã –∏ —Å–µ—Ç—Ç–µ—Ä—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
- [ ] –ú–µ—Ç–æ–¥—ã `equals()` –∏ `hashCode()` –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –ü–∞—Ä–æ–ª–∏ —Ö—ç—à–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π

```java
@Service
public class PasswordEncoder {
    public String encode(String rawPassword) {
        // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ BCrypt –∏–ª–∏ SHA-256
        return BCrypt.hashpw(rawPassword, BCrypt.gensalt());
    }
    
    public boolean matches(String rawPassword, String encodedPassword) {
        return BCrypt.checkpw(rawPassword, encodedPassword);
    }
}
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π

- –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
- –°–æ–¥–µ—Ä–∂–∏—Ç –±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-20

**–°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:**
- [ARCHITECTURE.md](../ARCHITECTURE.md) - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- [Development Guide](../guides/setup/development.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- [PLAN.md](../PLAN.md) - –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- [Backend Module](../modules/backend.md) - –û–ø–∏—Å–∞–Ω–∏–µ Backend –º–æ–¥—É–ª—è
- [Bank Module Entities](./bank-module.md) - –°—É—â–Ω–æ—Å—Ç–∏ –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ –º–æ–¥—É–ª—è

